(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c9141ea"],{"0c87":function(e,t,a){"use strict";var n=a("7a13"),o=a.n(n);o.a},5841:function(e,t,a){"use strict";a.d(t,"c",function(){return o}),a.d(t,"a",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"e",function(){return i}),a.d(t,"b",function(){return l});var n=a("6b6c"),o=function(e){return e.service="brokers",n["a"].request({url:"/",data:e,method:"post"})},r=function(e){return e.service="brokers.add",n["a"].request({url:"/",data:e,method:"post"})},s=function(e){return e.service="brokers.modify",n["a"].request({url:"/",data:e,method:"post"})},i=function(e){return e.service="brokers.remove",n["a"].request({url:"/",data:e,method:"post"})},l=function(e){return e.service="brokers.info",n["a"].request({url:"/",data:e,method:"post"})}},"7a13":function(e,t,a){},b9a0:function(e,t,a){},caf5:function(e,t,a){"use strict";var n=a("b9a0"),o=a.n(n);o.a},fcf0:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Card",{attrs:{shadow:""}},[a("p",{attrs:{slot:"title"},slot:"title"},[e._v("楼盘管理")]),a("a",{directives:[{name:"show",rawName:"v-show",value:e.canAdd,expression:"canAdd"}],attrs:{slot:"extra",role:"button"},on:{click:function(t){return t.preventDefault(),e.addBuilding(t)}},slot:"extra"},[a("Icon",{attrs:{type:"md-add-circle",size:16}}),e._v("添加楼盘\n        ")],1),a("Form",{ref:"formSearch",staticClass:"form-search",attrs:{"label-width":80,model:e.formSearch,inline:""},nativeOn:{submit:function(e){e.preventDefault()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchNow(t)}}},[a("FormItem",{attrs:{label:"所在国家",prop:"country_id"}},[a("Select",{on:{"on-change":e.loadCity},model:{value:e.formSearch.country_id,callback:function(t){e.$set(e.formSearch,"country_id",t)},expression:"formSearch.country_id"}},e._l(e.countryList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1),a("FormItem",{attrs:{label:"所在城市",prop:"city_id"}},[a("Select",{model:{value:e.formSearch.city_id,callback:function(t){e.$set(e.formSearch,"city_id",t)},expression:"formSearch.city_id"}},e._l(e.cityList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1),a("FormItem",{attrs:{label:"经纪人",prop:"broker_id"}},[a("Select",{model:{value:e.formSearch.broker_id,callback:function(t){e.$set(e.formSearch,"broker_id",t)},expression:"formSearch.broker_id"}},e._l(e.brokersList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1),a("FormItem",{attrs:{label:"热门楼盘",prop:"is_hot"}},[a("Select",{model:{value:e.formSearch.is_hot,callback:function(t){e.$set(e.formSearch,"is_hot",t)},expression:"formSearch.is_hot"}},[a("Option",{attrs:{value:"1"}},[e._v("是")]),a("Option",{attrs:{value:"0"}},[e._v("否")])],1)],1),a("FormItem",{attrs:{label:"中文名称",prop:"name_cn"}},[a("Input",{attrs:{placeholder:"输入楼盘中文名称"},model:{value:e.formSearch.name_cn,callback:function(t){e.$set(e.formSearch,"name_cn",t)},expression:"formSearch.name_cn"}})],1),a("FormItem",{attrs:{label:"英文名称",prop:"name_en"}},[a("Input",{attrs:{placeholder:"输入楼盘英文名称"},model:{value:e.formSearch.name_en,callback:function(t){e.$set(e.formSearch,"name_en",t)},expression:"formSearch.name_en"}})],1),a("FormItem",{attrs:{"label-width":0}},[a("Button",{attrs:{type:"primary"},on:{click:e.searchNow}},[e._v("搜索")])],1),a("FormItem",{attrs:{"label-width":0}},[a("Button",{attrs:{type:"default"},on:{click:e.searchReset}},[e._v("重置")])],1)],1),a("tables",{ref:"tables",attrs:{loading:e.tableLoading,columns:e.columns},model:{value:e.tableData,callback:function(t){e.tableData=t},expression:"tableData"}}),a("Page",{ref:"pager",staticStyle:{"margin-top":"15px"},attrs:{current:e.formSearch.page,total:e.total,"page-size":e.formSearch.pageSize,"page-size-opts":[20,40,60,100,500,1e3,5e3,1e4],"show-sizer":"","show-elevator":"","show-total":""},on:{"on-change":e.pageChange,"on-page-size-change":e.pageSizeChange}})],1),a("Modal",{attrs:{width:800,title:e.modalTitle,"mask-closable":!1},model:{value:e.showBuildingModal,callback:function(t){e.showBuildingModal=t},expression:"showBuildingModal"}},[a("Form",{ref:"formBuilding",attrs:{"label-width":80,model:e.formBuilding},nativeOn:{submit:function(e){e.preventDefault()}}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"所在国家",prop:"country_id",rules:{required:!0,message:"请选择国家",trigger:"change"}}},[a("Select",{on:{"on-change":e.loadCity},model:{value:e.formBuilding.country_id,callback:function(t){e.$set(e.formBuilding,"country_id",t)},expression:"formBuilding.country_id"}},e._l(e.countryList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"所在城市",prop:"city_id",rules:{required:!0,message:"请选择城市",trigger:"change"}}},[a("Select",{model:{value:e.formBuilding.city_id,callback:function(t){e.$set(e.formBuilding,"city_id",t)},expression:"formBuilding.city_id"}},e._l(e.cityList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"经纪人",prop:"broker_id",rules:{required:!0,message:"请选择经纪人",trigger:"change"}}},[a("Select",{model:{value:e.formBuilding.broker_id,callback:function(t){e.$set(e.formBuilding,"broker_id",t)},expression:"formBuilding.broker_id"}},e._l(e.brokersList,function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name_cn))])}),1)],1)],1)],1),a("FormItem",{attrs:{label:"楼盘名称"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_cn",rules:{required:!0,message:"请输入楼盘名称(中文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"中文楼盘名称",maxlength:255},model:{value:e.formBuilding.name_cn,callback:function(t){e.$set(e.formBuilding,"name_cn",t)},expression:"formBuilding.name_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_en",rules:{required:!0,message:"请输入楼盘姓名(英文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"英文楼盘名称",maxlength:255},model:{value:e.formBuilding.name_en,callback:function(t){e.$set(e.formBuilding,"name_en",t)},expression:"formBuilding.name_en"}})],1)],1)],1)],1),a("FormItem",{attrs:{label:"楼盘地址"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"address_cn",rules:{required:!0,message:"请输入楼盘地址(中文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"中文楼盘地址",maxlength:255},model:{value:e.formBuilding.address_cn,callback:function(t){e.$set(e.formBuilding,"address_cn",t)},expression:"formBuilding.address_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"address_en",rules:{required:!0,message:"请输入楼盘地址(英文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"英文楼盘地址",maxlength:255},model:{value:e.formBuilding.address_en,callback:function(t){e.$set(e.formBuilding,"address_en",t)},expression:"formBuilding.address_en"}})],1)],1)],1)],1),a("Row",[a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"交付时间",prop:"delivery_time"}},[a("Input",{attrs:{type:"text",placeholder:"输入交付时间",maxlength:255},model:{value:e.formBuilding.delivery_time,callback:function(t){e.$set(e.formBuilding,"delivery_time",t)},expression:"formBuilding.delivery_time"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"产权年限",prop:"property_years"}},[a("Input",{attrs:{type:"number",placeholder:"输入产权年限",maxlength:255},model:{value:e.formBuilding.property_years,callback:function(t){e.$set(e.formBuilding,"property_years",t)},expression:"formBuilding.property_years"}})],1)],1),a("Col",{attrs:{span:"8"}},[a("FormItem",{attrs:{label:"项目状态",prop:"project_status"}},[a("Select",{model:{value:e.formBuilding.project_status,callback:function(t){e.$set(e.formBuilding,"project_status",t)},expression:"formBuilding.project_status"}},e._l(e.projectStatusList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.title))])}),1)],1)],1)],1),a("FormItem",{attrs:{label:"贷款须知(中)",prop:"loans_cn"}},[a("editor",{ref:"loansCnEditor",attrs:{value:e.formBuilding.loans_cn},on:{"on-change":e.handleLoansCnChange}})],1),a("FormItem",{attrs:{label:"贷款须知(英)",prop:"loans_en"}},[a("editor",{ref:"loansEnEditor",attrs:{value:e.formBuilding.loans_en},on:{"on-change":e.handleLoansEnChange}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSaveBuilding}},[e.saving?a("span",[e._v("保存中")]):a("span",[e._v("确定")])]),a("Button",{attrs:{type:"default"},on:{click:e.handleCloseBuildingModal}},[e._v("关闭")])],1)],1),a("Modal",{attrs:{width:600,title:e.modalTitle,"mask-closable":!1},model:{value:e.showMediaModal,callback:function(t){e.showMediaModal=t},expression:"showMediaModal"}},[a("media-modal",{ref:"mediaModal"}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:function(t){e.showMediaModal=!1}}},[e._v("关闭")])],1)],1),a("Modal",{attrs:{width:600,title:e.modalTitle,"mask-closable":!1},model:{value:e.showApartmentModal,callback:function(t){e.showApartmentModal=t},expression:"showApartmentModal"}},[a("apartment-modal",{ref:"apartmentModal"}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:function(t){e.showApartmentModal=!1}}},[e._v("关闭")])],1)],1),a("Modal",{attrs:{width:700,title:e.modalTitle,"mask-closable":!1},model:{value:e.showTagsModal,callback:function(t){e.showTagsModal=t},expression:"showTagsModal"}},[a("tags-modal",{ref:"tagsModal"}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:function(t){e.showTagsModal=!1}}},[e._v("关闭")])],1)],1)],1)},o=[],r=(a("7f7f"),a("cebc")),s=a("fa69"),i=a("2f62"),l=a("f121"),c=a("a0f0"),d=a("5289"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("tables",{attrs:{size:"small",columns:e.columns,loading:e.tableLoading},model:{value:e.tableData,callback:function(t){e.tableData=t},expression:"tableData"}}),e.canAdd?a("Button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",size:"small",icon:"md-add-circle"},on:{click:function(t){return t.preventDefault(),e.handleApartmentShow(t)}}},[e._v("添加户型")]):e._e(),a("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1},model:{value:e.showApartmentModal,callback:function(t){e.showApartmentModal=t},expression:"showApartmentModal"}},[a("Form",{ref:"form",attrs:{"label-width":80,model:e.form},nativeOn:{submit:function(e){e.preventDefault()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSave(t)}}},[a("FormItem",{attrs:{label:"户型名称"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_cn",rules:{required:!0,message:"请输入户型名称(中文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"中文",maxlength:255},model:{value:e.form.name_cn,callback:function(t){e.$set(e.form,"name_cn",t)},expression:"form.name_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_en",rules:{required:!0,message:"请输入户型名称(英文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"英文",maxlength:255},model:{value:e.form.name_en,callback:function(t){e.$set(e.form,"name_en",t)},expression:"form.name_en"}})],1)],1)],1)],1),a("FormItem",{attrs:{label:"户型面积"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"area_cn"}},[a("Input",{attrs:{type:"text",placeholder:"中文",maxlength:255},model:{value:e.form.area_cn,callback:function(t){e.$set(e.form,"area_cn",t)},expression:"form.area_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"area_en"}},[a("Input",{attrs:{type:"text",placeholder:"英文",maxlength:255},model:{value:e.form.area_en,callback:function(t){e.$set(e.form,"area_en",t)},expression:"form.area_en"}})],1)],1)],1)],1),a("FormItem",{attrs:{label:"户型价格"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"price_cn"}},[a("Input",{attrs:{type:"text",placeholder:"中文",maxlength:255},model:{value:e.form.price_cn,callback:function(t){e.$set(e.form,"price_cn",t)},expression:"form.price_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"price_en"}},[a("Input",{attrs:{type:"text",placeholder:"英文",maxlength:255},model:{value:e.form.price_en,callback:function(t){e.$set(e.form,"price_en",t)},expression:"form.price_en"}})],1)],1)],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSave}},[e.saving?a("span",[e._v("保存中")]):a("span",[e._v("确定")])]),a("Button",{attrs:{type:"default"},on:{click:function(t){t.preventDefault(),e.showApartmentModal=!1}}},[e._v("关闭")])],1)],1)],1)},m=[],f=a("6b6c"),h=function(e){return e.service="buildings",f["a"].request({url:"/",data:e,method:"post"})},g=function(e){return e.service="buildings.add",f["a"].request({url:"/",data:e,method:"post"})},p=function(e){return e.service="buildings.modify",f["a"].request({url:"/",data:e,method:"post"})},v=function(e){return e.service="buildings.remove",f["a"].request({url:"/",data:e,method:"post"})},_=function(e){return e.service="buildings.info",f["a"].request({url:"/",data:e,method:"post"})},y=function(e){return e.service="buildings.apartments",f["a"].request({url:"/",data:e,method:"post"})},b=function(e){return e.service="buildings.apartmentAdd",f["a"].request({url:"/",data:e,method:"post"})},M=function(e){return e.service="buildings.apartmentModify",f["a"].request({url:"/",data:e,method:"post"})},w=function(e){return e.service="buildings.apartmentRemove",f["a"].request({url:"/",data:e,method:"post"})},k=function(e){return e.service="buildings.tags",f["a"].request({url:"/",data:e,method:"post"})},$=function(e){return e.service="buildings.tagInfo",f["a"].request({url:"/",data:e,method:"post"})},B=function(e){return e.service="buildings.tagAdd",f["a"].request({url:"/",data:e,method:"post"})},x=function(e){return e.service="buildings.tagModify",f["a"].request({url:"/",data:e,method:"post"})},I=function(e){return e.service="buildings.tagRemove",f["a"].request({url:"/",data:e,method:"post"})},S={components:{Tables:s["a"]},data:function(){var e=this;return{showApartmentModal:!1,tableLoading:!0,saving:!1,canAdd:!1,canRemove:!1,modalTitle:"",form:{id:"",building_id:"",name_cn:"",name_en:"",area_cn:"",area_en:"",price_cn:"",price_en:""},columns:[{title:"户型名称",key:"name_cn",align:"center"},{title:"面积",key:"area_cn",align:"center"},{title:"价格",key:"price_cn",align:"center"},{title:"操作",key:"handle",width:100,align:"center",button:[function(t,a,n){if(e.canModify)return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.handleModify(a)}}},"编辑")},function(t,a,n){if(e.canRemove)return t("Poptip",{props:{confirm:!0,title:"你确定要删除吗?"},style:{textAlign:"left"},on:{"on-ok":function(){e.handleRemove(a).then(function(e){n.$emit("input",a.tableData.filter(function(e,t){return t!==a.row.initRowIndex}))})}}},[t("Button",{props:{type:"text",size:"small"},style:{color:"#ed4014"}},"删除")])}]}],tableData:[]}},methods:{loadApartments:function(e){var t=this;e&&(this.form.building_id=e),this.tableLoading=!0,y({building_id:this.form.building_id}).then(function(e){t.tableLoading=!1;var a=e.data;"y"===a.status?t.tableData=a.data:t.$Message.error(a.msg)}).catch(function(e){})},handleApartmentShow:function(){this.showApartmentModal=!0,this.modalTitle="添加户型",this.$refs.form.resetFields(),this.form.id=""},handleSave:function(){var e=this;this.$refs.form.validate(function(t){t&&(e.saving=!0,""==e.form.id?b(e.form).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showApartmentModal=!1,e.$refs.form.resetFields(),e.loadApartments()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t.message)}):M(e.form).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showApartmentModal=!1,e.$refs.form.resetFields(),e.loadApartments()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t)}))})},handleRemove:function(e){var t=this;this.$Message.loading({content:"删除中...",duration:0});var a=e.row.id;return new Promise(function(e,n){w({id:a}).then(function(a){t.$Message.destroy();var n=a.data;"y"===n.status?(t.$Message.success(n.msg),e()):t.$Message.error(n.msg)}).catch(function(e){t.$Message.destroy()})})},handleModify:function(e){this.showApartmentModal=!0,this.modalTitle="编辑户型",this.form=e.row}}},T=S,C=a("2877"),F=Object(C["a"])(T,u,m,!1,null,null,null),A=F.exports,D=A,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("tables",{attrs:{size:"small",columns:e.columns,loading:e.tableLoading},model:{value:e.tableData,callback:function(t){e.tableData=t},expression:"tableData"}}),e.canAdd?a("Button",{staticStyle:{"margin-top":"10px"},attrs:{type:"primary",size:"small",icon:"md-add-circle"},on:{click:function(t){return t.preventDefault(),e.handleAdd(t)}}},[e._v("添加标签")]):e._e(),a("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1},model:{value:e.showTagsModal,callback:function(t){e.showTagsModal=t},expression:"showTagsModal"}},[a("Form",{ref:"formTags",attrs:{"label-width":80,model:e.form},nativeOn:{submit:function(e){e.preventDefault()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSaveTags(t)}}},[a("FormItem",{attrs:{label:"图标",prop:"icon.url",rules:{required:!0,message:"请上传图标",trigger:"change"}}},[a("div",{staticClass:"d-flex"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.form.icon.url.length>0,expression:"form.icon.url.length > 0"}],staticClass:"img-option",style:"background-image:url("+e.form.icon.url+")",on:{click:function(t){return t.preventDefault(),e.removeIcon(t)}}},[a("span",[e._v("删除")])]),a("Upload",{attrs:{action:e.baseUrl+"/upload/",name:"files","show-upload-list":!1,format:["jpg","jpeg","png","gif"],"max-size":2048,"on-success":e.handleUploadSuccess,"on-format-error":e.handleUploadFormatError,"on-exceeded-size":e.handleUploadMaxSize}},[a("Button",{attrs:{icon:"md-cloud-upload",size:"small"}},[e._v("上传")])],1)],1)]),a("FormItem",{attrs:{label:"名称"}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_cn",rules:{required:!0,message:"请输入标签名称(中文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"中文",maxlength:255},model:{value:e.form.name_cn,callback:function(t){e.$set(e.form,"name_cn",t)},expression:"form.name_cn"}})],1)],1),a("Col",{attrs:{span:"1"}},[e._v(" ")]),a("Col",{attrs:{span:"12"}},[a("FormItem",{attrs:{"label-width":0,prop:"name_en",rules:{required:!0,message:"请输入标签名称(英文)",trigger:"change"}}},[a("Input",{attrs:{type:"text",placeholder:"英文",maxlength:255},model:{value:e.form.name_en,callback:function(t){e.$set(e.form,"name_en",t)},expression:"form.name_en"}})],1)],1)],1)],1),a("FormItem",{attrs:{label:"描述(中文)",prop:"intro_cn"}},[a("Input",{attrs:{type:"text",placeholder:"中文",maxlength:255},model:{value:e.form.intro_cn,callback:function(t){e.$set(e.form,"intro_cn",t)},expression:"form.intro_cn"}})],1),a("FormItem",{attrs:{label:"描述(英文)",prop:"intro_en"}},[a("Input",{attrs:{type:"text",placeholder:"英文",maxlength:255},model:{value:e.form.intro_en,callback:function(t){e.$set(e.form,"intro_en",t)},expression:"form.intro_en"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:e.saving},on:{click:e.handleSaveTags}},[e.saving?a("span",[e._v("保存中")]):a("span",[e._v("确定")])]),a("Button",{attrs:{type:"default"},on:{click:e.handleCloseTagsModal}},[e._v("关闭")])],1)],1)],1)},L=[],q={components:{Tables:s["a"]},data:function(){var e=this;return{baseUrl:l["a"].baseUrl.pro,showTagsModal:!1,showMediaModal:!1,modalTitle:"",form:{id:"",building_id:"",name_cn:"",name_en:"",intro_cn:"",intro_en:"",icon:{url:"",name:"",file:""}},saving:!1,tableLoading:!0,canAdd:!1,canModify:!1,canRemove:!1,columns:[{title:"图标",width:66,align:"center",key:"icon",render:function(e,t){return e("img",{style:{width:"50px",height:"auto"},attrs:{src:t.row.icon}})}},{title:"中文名称",key:"name_cn",align:"center"},{title:"英文名称",key:"name_en",align:"center"},{title:"描述",key:"intro",align:"center"},{title:"添加时间",width:80,key:"time",align:"center"},{title:"操作",key:"handle",width:96,align:"center",className:"action-column",button:[function(t,a,n){if(e.canModify)return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.modifyTag(a)}}},"编辑")},function(t,a,n){if(e.canRemove)return t("Poptip",{props:{confirm:!0,title:"你确定要删除吗?"},style:{textAlign:"left"},on:{"on-ok":function(){e.removeTag(a).then(function(e){n.$emit("input",a.tableData.filter(function(e,t){return t!==a.row.initRowIndex}))})}}},[t("Button",{props:{type:"text",size:"small"},style:{color:"#ed4014"}},"删除")])}]}],tableData:[]}},methods:{handleAdd:function(){this.showTagsModal=!0,this.modalTitle="添加标签",this.$refs.formTags.resetFields(),this.form.id=""},handleSaveTags:function(){var e=this;this.$refs.formTags.validate(function(t){t&&(e.saving=!0,""==e.form.id?B(e.form).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showTagsModal=!1,e.$refs.formTags.resetFields(),e.loadTags()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t.message)}):x(e.form).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showTagsModal=!1,e.$refs.formTags.resetFields(),e.loadTags()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t)}))})},modifyTag:function(e){var t=this;this.getTagInfo(e.row.id).then(function(e){t.showTagsModal=!0,t.modalTitle="编辑标签信息",t.form=e.data})},handleCloseTagsModal:function(){this.showTagsModal=!1,this.$refs.formTags.resetFields()},getTagInfo:function(e){var t=this;return this.$Message.loading({content:"获取标签信息...",duration:0}),new Promise(function(a,n){$({id:e}).then(function(e){t.$Message.destroy();var n=e.data;"y"===n.status?a(n):t.$Message.error(n.msg)}).catch(function(e){t.$Message.destroy()})})},removeTag:function(e){var t=this;this.$Message.loading({content:"删除中...",duration:0});var a=e.row.id;return new Promise(function(e,n){I({id:a}).then(function(a){t.$Message.destroy();var n=a.data;"y"===n.status?(t.$Message.success(n.msg),e()):t.$Message.error(n.msg)}).catch(function(e){t.$Message.destroy()})})},loadTags:function(e){var t=this;e&&(this.form.building_id=e),this.tableLoading=!0,k({building_id:this.form.building_id}).then(function(e){t.tableLoading=!1;var a=e.data;"y"===a.status?t.tableData=a.data:t.$Message.error(a.msg)}).catch(function(e){})},handleUploadSuccess:function(e,t){"y"===e.status?this.form.icon=e.data:this.$Message.error(e.msg)},handleUploadFormatError:function(e){this.$Notice.warning({title:"文件格式错误",desc:"文件 "+e.name+" 格式不正确, 仅支持png, jpg, jpeg, gif格式."})},handleUploadMaxSize:function(e){this.$Notice.warning({title:"文件大小超出限制",desc:"文件  "+e.name+" 太大了, 不能超过2M."})},removeIcon:function(){this.form.icon={file:"",name:"",url:""}}}},R=q,O=(a("caf5"),Object(C["a"])(R,z,L,!1,null,"5e503fee",null)),E=O.exports,j=E,P=a("7e1e"),U=a("5841"),N={components:{Tables:s["a"],Editor:c["a"],MediaModal:d["a"],ApartmentModal:D,TagsModal:j},data:function(){var e=this;return{baseUrl:l["a"].baseUrl.pro,showBuildingModal:!1,showMediaModal:!1,showApartmentModal:!1,showTagsModal:!1,modalTitle:"",formSearch:{country_id:"",city_id:"",broker_id:"",is_hot:"",name_cn:"",name_en:"",page:1,pageSize:20},total:0,formBuilding:{id:"",country_id:"",city_id:"",broker_id:"",name_cn:"",name_en:"",address_cn:"",address_en:"",delivery_time:"",property_years:"",project_status:"0",loans_cn:"",loans_en:""},saving:!1,tableLoading:!0,canAdd:!1,canModify:!1,canRemove:!1,canMedia:!1,columns:[{title:"ID",width:60,key:"ID"},{title:"中文名称",key:"name_cn",align:"center"},{title:"英文名称",key:"name_en",align:"center"},{title:"所在国家",key:"country",align:"center"},{title:"所在城市",key:"city",align:"center"},{title:"经纪人",key:"broker",align:"center"},{title:"交付时间",key:"delivery_time",align:"center"},{title:"产权年限",key:"property_years",align:"center"},{title:"项目状态",key:"project_status",align:"center"},{title:"精品楼盘",key:"is_hot",align:"center",render:function(t,a){return t("Checkbox",{props:{value:1==a.row.is_hot},on:{"on-change":function(){e.setBuildingHot(a.row.id)}}})}},{title:"添加时间",width:80,key:"time",align:"center"},{title:"操作",key:"handle",width:390,align:"center",className:"action-column",button:[function(t,a,n){return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showPDF(a,"cn")}}},"PDF(中)")},function(t,a,n){return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showPDF(a,"en")}}},"PDF(英)")},function(t,a,n){return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showApartment(a)}}},"户型")},function(t,a,n){return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showTags(a)}}},"标签")},function(t,a,n){return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showProcess(a)}}},"购房流程")},function(t,a,n){if(e.canMedia)return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.showMedia(a)}}},"媒体")},function(t,a,n){if(e.canModify)return t("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){e.modifyBuilding(a)}}},"编辑")},function(t,a,n){if(e.canRemove)return t("Poptip",{props:{confirm:!0,title:"你确定要删除吗?"},style:{textAlign:"left"},on:{"on-ok":function(){e.removeBuilding(a).then(function(e){n.$emit("input",a.tableData.filter(function(e,t){return t!==a.row.initRowIndex}))})}}},[t("Button",{props:{type:"text",size:"small"},style:{color:"#ed4014"}},"删除")])}]}],tableData:[],countryList:[],cityList:[],brokersList:[],projectStatusList:[]}},methods:Object(r["a"])({},Object(i["b"])(["userCan","getConstants"]),{searchNow:function(){this.formSearch.page=1,this.loadBuildings()},searchReset:function(){this.formSearch.name="",this.$refs.formSearch.resetFields(),this.loadBuildings()},pageChange:function(e){this.formSearch.page=e,this.loadBuildings()},pageSizeChange:function(e){this.formSearch.pageSize=e,this.loadBuildings()},addBuilding:function(){this.showBuildingModal=!0,this.modalTitle="添加楼盘",this.$refs.formBuilding.resetFields(),this.formBuilding.id="",this.$refs.loansCnEditor.setHtml(""),this.$refs.loansEnEditor.setHtml("")},handleSaveBuilding:function(){var e=this;this.$refs.formBuilding.validate(function(t){t&&(e.saving=!0,""==e.formBuilding.id?g(e.formBuilding).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showBuildingModal=!1,e.$refs.formBuilding.resetFields(),e.loadBuildings()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t.message)}):p(e.formBuilding).then(function(t){e.saving=!1;var a=t.data;"y"===a.status?(e.$Message.success(a.msg),e.showBuildingModal=!1,e.$refs.formBuilding.resetFields(),e.loadBuildings()):e.$Message.error(a.msg)}).catch(function(t){e.saving=!1,e.$Message.error(t)}))})},modifyBuilding:function(e){var t=this;this.getBuildingInfo(e.row.id).then(function(e){t.showBuildingModal=!0,t.modalTitle="编辑楼盘信息",t.formBuilding=e.data,t.$refs.loansCnEditor.setHtml(t.formBuilding.loans_cn),t.$refs.loansEnEditor.setHtml(t.formBuilding.loans_en),t.loadCity(e.data.country_id)})},handleCloseBuildingModal:function(){this.showBuildingModal=!1,this.$refs.formBuilding.resetFields()},handleLoansCnChange:function(e,t){this.formBuilding.loans_cn=e},handleLoansEnChange:function(e,t){this.formBuilding.loans_en=e},setBuildingHot:function(e){var t=this;p({act:"hot",id:e}).then(function(e){var a=e.data;"y"===a.status?t.$Message.success(a.msg):t.$Message.error(a.msg)}).catch(function(e){t.$Message.error(e)})},getBuildingInfo:function(e){var t=this;return this.$Message.loading({content:"获取楼盘信息...",duration:0}),new Promise(function(a,n){_({id:e}).then(function(e){t.$Message.destroy();var n=e.data;"y"===n.status?a(n):t.$Message.error(n.msg)}).catch(function(e){t.$Message.destroy()})})},removeBuilding:function(e){var t=this;this.$Message.loading({content:"删除中...",duration:0});var a=e.row.id;return new Promise(function(e,n){v({id:a}).then(function(a){t.$Message.destroy();var n=a.data;"y"===n.status?(t.$Message.success(n.msg),e()):t.$Message.error(n.msg)}).catch(function(e){t.$Message.destroy()})})},loadBuildings:function(){var e=this;this.tableLoading=!0,h({search:this.formSearch}).then(function(t){e.tableLoading=!1;var a=t.data;"y"===a.status?(e.formSearch.pageSize=a.data.size,e.total=a.data.total,e.tableData=a.data.data):e.$Message.error(a.msg)}).catch(function(e){})},handleUploadSuccess:function(e,t){"y"===e.status?this.formBuilding.avatar=e.data:this.$Message.error(e.msg)},handleUploadFormatError:function(e){this.$Notice.warning({title:"文件格式错误",desc:"文件 "+e.name+" 格式不正确, 仅支持pdf格式."})},handleUploadMaxSize:function(e){this.$Notice.warning({title:"文件大小超出限制",desc:"文件  "+e.name+" 太大了, 不能超过50M."})},removeAvatar:function(){this.formBuilding.avatar={file:"",name:"",url:""}},loadCountry:function(){var e=this;Object(P["h"])({}).then(function(t){var a=t.data;"y"===a.status&&(e.countryList=a.data.data)}).catch(function(e){})},loadCity:function(e){var t=this;Object(P["f"])({search:{country_id:e}}).then(function(e){var a=e.data;"y"===a.status&&(t.cityList=a.data.data)}).catch(function(e){})},loadBrokers:function(){var e=this;Object(U["c"])({}).then(function(t){var a=t.data;"y"===a.status&&(e.brokersList=a.data.data)}).catch(function(e){})},showApartment:function(e){this.showApartmentModal=!0,this.modalTitle="「"+e.row.name_cn+"」户型",this.$refs.apartmentModal.canAdd=this.canAdd,this.$refs.apartmentModal.canModify=this.canModify,this.$refs.apartmentModal.canRemove=this.canRemove,this.$refs.apartmentModal.loadApartments(e.row.id)},showTags:function(e){this.showTagsModal=!0,this.modalTitle="「"+e.row.name_cn+"」标签",this.$refs.tagsModal.canAdd=this.canAdd,this.$refs.tagsModal.canModify=this.canModify,this.$refs.tagsModal.canRemove=this.canRemove,this.$refs.tagsModal.loadTags(e.row.id)},showMedia:function(e){this.showMediaModal=!0,this.modalTitle="「"+e.row.name_cn+"」媒体资源",this.$refs.mediaModal.loadMediaList(3,e.row.id)},showProcess:function(e){this.showMediaModal=!0,this.modalTitle="「"+e.row.name_cn+"」购房流程",this.$refs.mediaModal.loadMediaList(4,e.row.id)},showPDF:function(e,t){this.showMediaModal=!0,this.modalTitle="「"+e.row.name_cn+"」PDF("+("中"==t?"CN":"英")+")",this.$refs.mediaModal.loadMediaList("cn"==t?5:6,e.row.id)}}),mounted:function(){var e=this;this.loadBuildings(),this.loadCountry(),this.loadBrokers(),this.userCan("Buildings_Add").then(function(t){e.canAdd=t}),this.userCan("Buildings_Modify").then(function(t){e.canModify=t}),this.userCan("Buildings_Remove").then(function(t){e.canRemove=t}),this.userCan("Data_Media").then(function(t){e.canMedia=t}),this.getConstants().then(function(t){e.projectStatusList=t.PROJECT_STATUS})}},H=N,J=(a("0c87"),Object(C["a"])(H,n,o,!1,null,"0348534a",null));t["default"]=J.exports}}]);